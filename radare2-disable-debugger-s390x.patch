From 260433915cbaa515a900d49e5b2498cde7620fb2 Mon Sep 17 00:00:00 2001
From: Riccardo Schirone <sirmy15@gmail.com>
Date: Tue, 16 Oct 2018 09:48:31 +0200
Subject: [PATCH] meson.build: disable debugger features on Linux/s390x

Debugging is not supported on Linux/s390x and compilation there doesn't work.
This patch disables the debugging features completely, until upstream will have
proper support for Linux/s390x.
---
 meson.build | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/meson.build b/meson.build
index 5af7d29ec..459e6722f 100644
--- a/meson.build
+++ b/meson.build
@@ -265,13 +265,15 @@ use_ptrace_wrap = ['linux'].contains(host_machine.system())
 message('HAVE_PTRACE: @0@'.format(have_ptrace))
 message('USE_PTRACE_WRAP: @0@'.format(use_ptrace_wrap))
 
+has_debugger = not (host_machine.system() == 'linux' and host_machine.cpu_family() == 's390x')
+
 userconf = configuration_data()
 userconf.set('R_CHECKS_LEVEL', get_option('checks_level'))
 userconf.set('HAVE_LIB_MAGIC', sys_magic.found().to_int())
 userconf.set('USE_LIB_MAGIC', use_syslib_magic.to_int())
 userconf.set('HAVE_LIB_XXHASH', sys_xxhash.found().to_int())
 userconf.set('USE_LIB_XXHASH', use_sys_xxhash.to_int())
-userconf.set('DEBUGGER', 1)
+userconf.set('DEBUGGER', has_debugger.to_int())
 userconf.set('PREFIX', r2_prefix)
 userconf.set('LIBDIR', r2_libdir)
 userconf.set('INCLUDEDIR', r2_incdir)
-- 
2.14.4

